<<<<<<< HEAD
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>TheHER demo</title>
  </head>
  <body>
    <h1>TheHER ‚Äî MVC demo</h1>
    <p>Click the button to run a demo fit (uses synthetic data if no file provided).</p>

    <form id="fitForm">
      <label>Model:
        <select name="model_type">
          <option value="simplified">simplified</option>
          <option value="full">full</option>
        </select>
      </label>
      <label>bbv: <input name="bbv" type="number" step="0.01" value="0.5"/></label>
      <label>bbh: <input name="bbh" type="number" step="0.01" value="0.5"/></label>
      <label>Ref potential (V vs SHE): <input name="ref_potential" type="number" step="0.001" value="0.0"/></label>
      <label>Electrolyte pH: <input name="pH" type="number" step="0.1" value="1.0"/></label>
      <label>Or provide final reference correction (V): <input name="ref_correction" type="number" step="0.0001" placeholder="e.g. 0.924"/></label>
      <label>Ohmic drop (mV): <input name="ohmic_drop" type="number" step="0.01" value="6.43" required/></label>
      <label>Electrode area (cm¬≤): <input name="area_electrode" type="number" step="0.0001" value="0.5" required/></label>
      <label>Current units:
        <select name="current_units">
          <option value="mA" selected>mA</option>
          <option value="A">A</option>
        </select>
      </label>
      <label>Current column (1-based): <input name="current_col" type="number" step="1" value="1" min="1" required/></label>
      <label>Potential column (1-based): <input name="potential_col" type="number" step="1" value="2" min="1" required/></label>
      <label>Upload data file: <input name="datafile" type="file" accept=".txt,.csv" required/></label>
      <label>Delimiter:
        <select name="delimiter">
          <option value="auto" selected>Auto-detect</option>
            <option value="," >Comma (,)</option>
          <option value="\t">Tab (\t)</option>
          <option value=";">Semicolon (;)</option>
          <option value=" ">Space</option>
        </select>
      </label>
      <label>Temperature (K): <input name="temperature" type="number" step="0.1" value="298.15"/></label>
      <label>vary_bbv: <input name="vary_bbv" type="checkbox" checked/></label>
      <label>vary_bbh: <input name="vary_bbh" type="checkbox" checked/></label>
      <label>method:
        <select name="fitting_method">
          <option value="powell">powell</option>
          <option value="nelder">nelder</option>
        </select>
      </label>
      <button type="submit">Run Fit</button>
    </form>

    <img id="plot" alt="fit plot" style="max-width:90%;border:1px solid #ccc;"/>
    <pre id="output"></pre>

    <script>
      document.getElementById('fitForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const form = new FormData(e.target);

        // fetch image from /plot
        const resp = await fetch('/plot', { method: 'POST', body: form });
        if (resp.ok) {
          const blob = await resp.blob();
          const url = URL.createObjectURL(blob);
          document.getElementById('plot').src = url;
        } else {
          const j = await resp.json();
          document.getElementById('output').textContent = JSON.stringify(j, null, 2);
        }

        // also fetch JSON summary from /fit for parameter details
        const resp2 = await fetch('/fit', { method: 'POST', body: form });
        const j2 = await resp2.json();
        document.getElementById('output').textContent = JSON.stringify(j2, null, 2);
      });
    </script>
  </body>
=======
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HER Analysis - Hydrogen Evolution Reaction Fitting</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî¨ HER Analysis Platform</h1>
            <p class="subtitle">Hydrogen Evolution Reaction Electrochemical Data Fitting</p>
        </header>

        <div class="main-content">
            <section class="card">
                <h2>üìÅ Step 1: Upload Data</h2>
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="dataFile">Select LSV Data File (.txt, .csv):</label>
                        <input type="file" id="dataFile" name="file" accept=".txt,.csv" required>
                        <small>Supports any separator (comma, tab, space, semicolon)</small>
                    </div>
                    
                    <h3>üìä Column Configuration</h3>
                    <div class="parameters-grid">
                        <div class="form-group">
                            <label for="currentColumn">Current Column (0-based index):</label>
                            <input type="number" id="currentColumn" name="current_column" value="0" min="0" required>
                            <small>First column = 0, Second = 1, etc.</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="potentialColumn">Potential Column (0-based index):</label>
                            <input type="number" id="potentialColumn" name="potential_column" value="1" min="0" required>
                            <small>First column = 0, Second = 1, etc.</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="skipRows">Rows to Skip (header lines):</label>
                            <input type="number" id="skipRows" name="skip_rows" value="1" min="0" required>
                            <small>Number of header rows to skip</small>
                        </div>
                    </div>
                    
                    <h3>‚öôÔ∏è Experimental Parameters</h3>
                    <div class="parameters-grid">
                        <div class="form-group">
                            <label for="areaElectrode">Electrode Area (cm¬≤):</label>
                            <input type="number" id="areaElectrode" name="area_electrode" value="0.5" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="ohmicDrop">Ohmic Drop (Œ©):</label>
                            <input type="number" id="ohmicDrop" name="ohmic_drop" value="6.43" step="0.01" required>
                            <small>raw value, without area correction</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="pH">pH:</label>
                            <input type="number" id="pH" name="pH" value="7" step="0.1" required>
                            <small>pH of solution</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="refElectrode">Reference Electrode Potential (V):</label>
                            <input type="number" id="refElectrode" name="ref_electrode" value="0.098" step="0.001" required>
                            <small>Potential of reference electrode used</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="temperature">Temperature (K):</label>
                            <input type="number" id="temperature" name="temperature" value="298.15" step="0.01" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="gasConstant">Gas Constant (J/(mol¬∑K)):</label>
                            <input type="number" id="gasConstant" name="gas_constant" value="8.314" step="0.001" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-sm">Upload & Process Data</button>
                </form>
                <div id="uploadStatus" class="status-message"></div>
                
                <div id="rawPreview" class="data-preview" style="display:none;">
                    <h3>üìÑ Raw File Preview (First 10 Lines)</h3>
                    <div class="raw-lines-container">
                        <table id="rawLinesTable">
                            <thead><tr><th>Line</th><th>Content</th></tr></thead>
                            <tbody id="rawLinesBody"></tbody>
                        </table>
                    </div>
                </div>
                
                <div id="dataPreview" class="data-preview" style="display:none;">
                    <h3>üìã Processed Data Preview (First 5 Points)</h3>
                    <p><strong>After applying corrections:</strong></p>
                    <table id="previewTable">
                        <thead><tr><th>Current (A/cm¬≤)</th><th>Potential (V vs RHE)</th></tr></thead>
                        <tbody id="previewBody"></tbody>
                    </table>
                </div>
            </section>

            <section class="card" id="fittingSection" style="display: none;">
                <h2>‚öôÔ∏è Step 2: Configure Fitting</h2>
                <div class="form-group">
                    <label>Model Type:</label>
                    <select id="modelType">
                        <option value="simplified">Simplified (2-step: Volmer-Heyrovsky)</option>
                        <option value="full">Full (3-step: Volmer-Heyrovsky-Tafel)</option>
                    </select>
                </div>
                <div class="parameters-grid">
                    <div class="form-group">
                        <label for="bbvInitial">Initial bbv (Volmer Œ≤):</label>
                        <input type="number" id="bbvInitial" value="0.5" min="0" max="1" step="0.01">
                        <label style="display: inline-block; margin-top: 5px;">
                            <input type="checkbox" id="varyBbv" checked> Allow to vary during fitting
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="bbhInitial">Initial bbh (Heyrovsky Œ≤):</label>
                        <input type="number" id="bbhInitial" value="0.5" min="0" max="1" step="0.01">
                        <label style="display: inline-block; margin-top: 5px;">
                            <input type="checkbox" id="varyBbh" checked> Allow to vary during fitting
                        </label>
                    </div>
                </div>
                <button id="fitBtn" class="btn btn-primary btn-sm">Fit Data</button>
                <div id="fitStatus" class="status-message"></div>
            </section>

            <section class="card" id="resultsSection" style="display: none;">
                <h2>üìä Results</h2>
                <div class="results-container">
                    <div class="parameters-display">
                        <h3>Fitted Parameters</h3>
                        <table id="paramsTable">
                            <thead><tr><th>Parameter</th><th>Value</th></tr></thead>
                            <tbody id="paramsBody"></tbody>
                        </table>
                        <h3>Statistics</h3>
                        <div id="statsDisplay"></div>
                    </div>
                    <div class="interactive-controls">
                        <h3>üéõÔ∏è Interactive Parameters</h3>
                        <div id="sliderControls"></div>
                        <button id="updateBtn" class="btn btn-secondary">Update Plot</button>
                    </div>
                    <div class="export-controls">
                        <h3>üì• Export Results</h3>
                        <button id="exportBtn" class="btn btn-primary btn-sm">Download All Results (.zip)</button>
                        <small>Includes: parameters, statistics, curves (current-potential, surface coverage, Tafel slopes)</small>
                    </div>
                </div>
                <div class="plots-grid">
                    <div id="plot1" class="plot-container"></div>
                    <div id="plot2" class="plot-container"></div>
                    <div id="plot3" class="plot-container"></div>
                </div>
            </section>
        </div>
        <footer>
            <div class="footer-content">
                <div class="footer-section">
                    <h4>HER Analysis Platform</h4>
                    <p><a href="https://github.com/jm96ps/TheHER" target="_blank">üîó GitHub Repository</a></p>
                </div>
                <div class="footer-section">
                    <h4>Author</h4>
                    <p><strong>James Silva</strong>, PhD Candidate</p>
                    <p>IQSC-USP (Institute of Chemistry of S√£o Carlos - University of S√£o Paulo)</p>
                    <p>üìß <a href="mailto:jamesmario@usp.br">jamesmario@usp.br</a></p>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <p><a href="https://buymeacoffee.com/jm96ps" target="_blank" class="coffee-btn">‚òï Buy me a coffee</a></p>
                </div>
            </div>
        </footer>
    </div>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
>>>>>>> 5602c2a428d223259f21bca9ff03240ae08bfe2f
</html>
